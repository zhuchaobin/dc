<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xai.tt.dc.biz.mapper.T1ARInfMapper">
  <resultMap id="BaseResultMap" type="com.xai.tt.dc.client.model.T1ARInf">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="ID" property="id" jdbcType="BIGINT" />
    <result column="AR_ID" property="arId" jdbcType="CHAR" />
    <result column="PROCESS_INST_ID" property="processInstId" jdbcType="VARCHAR" />
    <result column="AR_Tp" property="arTp" jdbcType="CHAR" />
    <result column="Pch_Prty" property="pchPrty" jdbcType="VARCHAR" />
    <result column="AR_StDt" property="arStdt" jdbcType="CHAR" />
    <result column="AR_EdDt" property="arEddt" jdbcType="CHAR" />
    <result column="Splr" property="splr" jdbcType="VARCHAR" />
    <result column="PckUpGds_Cyc" property="pckupgdsCyc" jdbcType="INTEGER" />
    <result column="Agrm_Stg" property="agrmStg" jdbcType="VARCHAR" />
    <result column="BTp" property="btp" jdbcType="CHAR" />
    <result column="Fnc_Pctg" property="fncPctg" jdbcType="REAL" />
    <result column="Prpy_Gld_Rto" property="prpyGldRto" jdbcType="REAL" />
    <result column="Lmt" property="lmt" jdbcType="REAL" />
    <result column="Crdn" property="crdn" jdbcType="REAL" />
    <result column="Clspos_Ln" property="clsposLn" jdbcType="REAL" />
    <result column="SvcFee_CMd" property="svcfeeCmd" jdbcType="CHAR" />
    <result column="SplOv_CrrOv_Mod" property="splovCrrovMod" jdbcType="CHAR" />
    <result column="AR_St" property="arSt" jdbcType="CHAR" />
    <result column="Tms" property="tms" jdbcType="TIMESTAMP" />
    <result column="Crt_Psn" property="crtPsn" jdbcType="VARCHAR" />
    <result column="Crt_Tm" property="crtTm" jdbcType="TIMESTAMP" />
    <result column="Cfm_Psn" property="cfmPsn" jdbcType="VARCHAR" />
    <result column="Cfm_Tm" property="cfmTm" jdbcType="TIMESTAMP" />
    <result column="FrstIns_CkOp" property="frstinsCkop" jdbcType="VARCHAR" />
    <result column="FrstIns_Adt_Psn" property="frstinsAdtPsn" jdbcType="VARCHAR" />
    <result column="FrstIns_Adt_Tm" property="frstinsAdtTm" jdbcType="TIMESTAMP" />
    <result column="Bnk" property="bnk" jdbcType="INTEGER" />
    <result column="Lgstc" property="lgstc" jdbcType="INTEGER" />
    <result column="Ins_Co" property="insCo" jdbcType="INTEGER" />
    <result column="SplChain" property="splchain" jdbcType="INTEGER" />
    <result column="SndInsc_CkOp" property="sndinscCkop" jdbcType="VARCHAR" />
    <result column="SndIns_Adt_Psn" property="sndinsAdtPsn" jdbcType="VARCHAR" />
    <result column="SndIns_Adt_Tm" property="sndinsAdtTm" jdbcType="TIMESTAMP" />
    <result column="Plchd" property="plchd" jdbcType="VARCHAR" />
    <result column="Plchd_Adr" property="plchdAdr" jdbcType="VARCHAR" />
    <result column="Insrd" property="insrd" jdbcType="VARCHAR" />
    <result column="Insrd_Adr" property="insrdAdr" jdbcType="VARCHAR" />
    <result column="Fst_Benf" property="fstBenf" jdbcType="VARCHAR" />
    <result column="Fst_Benf_Adr" property="fstBenfAdr" jdbcType="VARCHAR" />
    <result column="Ins_Pty_Adr" property="insPtyAdr" jdbcType="VARCHAR" />
    <result column="Ins_Obj_Nm" property="insObjNm" jdbcType="VARCHAR" />
    <result column="Ins_Amt" property="insAmt" jdbcType="REAL" />
    <result column="Dctb_Amt" property="dctbAmt" jdbcType="REAL" />
    <result column="EpAp" property="epap" jdbcType="VARCHAR" />
    <result column="Ins_StDt" property="insStdt" jdbcType="CHAR" />
    <result column="Ins_EdDt" property="insEddt" jdbcType="CHAR" />
  </resultMap>
   	<sql id="query_criteria">  
  	  <if test="id  != null and id  != ''">
        and ID  = #{id ,jdbcType=INTEGER}
      </if>
      <if test="arId  != null and arId  != ''">
        and AR_ID  = #{arId ,jdbcType=VARCHAR}
      </if>
      <if test="arTp  != null and arTp  != ''">
        and AR_Tp  = #{arTp ,jdbcType=VARCHAR}
      </if>
      <if test="pchPrty  != null and pchPrty  != ''">
        and Pch_Prty  = #{pchPrty ,jdbcType=VARCHAR}
      </if>
      <if test="arStdt  != null and arStdt  != ''">
        and AR_StDt  = #{arStdt ,jdbcType=VARCHAR}
      </if>
      <if test="arEddt  != null and arEddt  != ''">
        and AR_EdDt  = #{arEddt ,jdbcType=VARCHAR}
      </if>
      <if test="splr  != null and splr  != ''">
        and Splr  = #{splr ,jdbcType=VARCHAR}
      </if>
      <if test="pckupgdsCyc  != null and pckupgdsCyc  != ''">
        and PckUpGds_Cyc  = #{pckupgdsCyc ,jdbcType=INTEGER}
      </if>
      <if test="agrmStg  != null and agrmStg  != ''">
        and Agrm_Stg  = #{agrmStg ,jdbcType=VARCHAR}
      </if>
      <if test="btp  != null and btp  != ''">
        and BTp  = #{btp ,jdbcType=VARCHAR}
      </if>
      <if test="fncPctg  != null and fncPctg  != ''">
        and Fnc_Pctg  = #{fncPctg ,jdbcType=VARCHAR}
      </if>
      <if test="prpyGldRto  != null and prpyGldRto  != ''">
        and Prpy_Gld_Rto  = #{prpyGldRto ,jdbcType=VARCHAR}
      </if>
      <if test="lmt  != null and lmt  != ''">
        and Lmt  = #{lmt ,jdbcType=VARCHAR}
      </if>
      <if test="crdn  != null and crdn  != ''">
        and Crdn  = #{crdn ,jdbcType=VARCHAR}
      </if>
      <if test="clsposLn  != null and clsposLn  != ''">
        and Clspos_Ln  = #{clsposLn ,jdbcType=VARCHAR}
      </if>
      <if test="svcfeeCmd  != null and svcfeeCmd  != ''">
        and SvcFee_CMd  = #{svcfeeCmd ,jdbcType=VARCHAR}
      </if>
      <if test="splovCrrovMod  != null and splovCrrovMod  != ''">
        and SplOv_CrrOv_Mod  = #{splovCrrovMod ,jdbcType=VARCHAR}
      </if>
      <if test="arSt  != null and arSt  != ''">
        and AR_St  = #{arSt ,jdbcType=VARCHAR}
      </if>
      <if test="tms  != null and tms  != ''">
        and Tms  = #{tms ,jdbcType=TIMESTAMP}
      </if>
      <if test="crtPsn  != null and crtPsn  != ''">
        and Crt_Psn  = #{crtPsn ,jdbcType=VARCHAR}
      </if>
      <if test="crtTm  != null and crtTm  != ''">
        and Crt_Tm  = #{crtTm ,jdbcType=TIMESTAMP}
      </if>
      <if test="cfmPsn  != null and cfmPsn  != ''">
        and Cfm_Psn  = #{cfmPsn ,jdbcType=VARCHAR}
      </if>
      <if test="cfmTm  != null and cfmTm  != ''">
        and Cfm_Tm  = #{cfmTm ,jdbcType=TIMESTAMP}
      </if>
      <if test="frstinsCkop  != null and frstinsCkop  != ''">
        and FrstIns_CkOp  = #{frstinsCkop ,jdbcType=VARCHAR}
      </if>
      <if test="frstinsAdtPsn  != null and frstinsAdtPsn  != ''">
        and FrstIns_Adt_Psn  = #{frstinsAdtPsn ,jdbcType=VARCHAR}
      </if>
      <if test="frstinsAdtTm  != null and frstinsAdtTm  != ''">
        and FrstIns_Adt_Tm  = #{frstinsAdtTm ,jdbcType=TIMESTAMP}
      </if>
      <if test="sndinscCkop  != null and sndinscCkop  != ''">
        and SndInsc_CkOp  = #{sndinscCkop ,jdbcType=VARCHAR}
      </if>
      <if test="sndinsAdtPsn  != null and sndinsAdtPsn  != ''">
        and SndIns_Adt_Psn  = #{sndinsAdtPsn ,jdbcType=VARCHAR}
      </if>
      <if test="sndinsAdtTm  != null and sndinsAdtTm  != ''">
        and SndIns_Adt_Tm  = #{sndinsAdtTm ,jdbcType=TIMESTAMP}
      </if>  
	</sql>
  	
   <sql id="Base_Column_List">
     ID,AR_ID,PROCESS_INST_ID,AR_Tp,Pch_Prty,AR_StDt,AR_EdDt,Splr,PckUpGds_Cyc,Agrm_Stg,BTp,Fnc_Pctg,Prpy_Gld_Rto,Lmt,Crdn,Clspos_Ln,SvcFee_CMd,SplOv_CrrOv_Mod,AR_St,Tms,Crt_Psn,Crt_Tm,Cfm_Psn,Cfm_Tm,FrstIns_CkOp,FrstIns_Adt_Psn,FrstIns_Adt_Tm,Bnk,Lgstc,Ins_Co,SplChain,SndInsc_CkOp,SndIns_Adt_Psn,SndIns_Adt_Tm,Plchd,Plchd_Adr,Insrd,Insrd_Adr,Fst_Benf,Fst_Benf_Adr,Ins_Pty_Adr,Ins_Obj_Nm,Ins_Amt,Dctb_Amt,EpAp,Ins_StDt,Ins_EdDt
   </sql>
  
   <select id="selectByT1ARInfDcQuery" parameterType="com.xai.tt.dc.client.vo.inVo.TB0001InVo" resultType="com.xai.tt.dc.client.vo.T1ARInfVo">
	    SELECT
	    distinct
	    t6.ID as id,
t6.AR_ID as arId,
t6.PROCESS_INST_ID as processInstId,
t6.AR_Tp as arTp,
t6.Pch_Prty as pchPrty,
t6.AR_StDt as arStdt,
t6.AR_EdDt as arEddt,
t6.Splr as splr,
t6.PckUpGds_Cyc as pckupgdsCyc,
t6.Agrm_Stg as agrmStg,
t6.BTp as btp,
t6.Fnc_Pctg as fncPctg,
t6.Prpy_Gld_Rto as prpyGldRto,
t6.Lmt as lmt,
t6.Crdn as crdn,
t6.Clspos_Ln as clsposLn,
t6.SvcFee_CMd as svcfeeCmd,
t6.SplOv_CrrOv_Mod as splovCrrovMod,
t6.AR_St as arSt,
t6.Tms as tms,
t6.Crt_Psn as crtPsn,
t6.Crt_Tm as crtTm,
t6.Cfm_Psn as cfmPsn,
t6.Cfm_Tm as cfmTm,
t6.FrstIns_CkOp as frstinsCkop,
t6.FrstIns_Adt_Psn as frstinsAdtPsn,
t6.FrstIns_Adt_Tm as frstinsAdtTm,
t6.Bnk as bnk,
t6.Lgstc as lgstc,
t6.Ins_Co as insCo,
t6.SplChain as splchain,
t6.SndInsc_CkOp as sndinscCkop,
t6.SndIns_Adt_Psn as sndinsAdtPsn,
t6.SndIns_Adt_Tm as sndinsAdtTm,
t6.Plchd as plchd,
t6.Plchd_Adr as plchdAdr,
t6.Insrd as insrd,
t6.Insrd_Adr as insrdAdr,
t6.Fst_Benf as fstBenf,
t6.Fst_Benf_Adr as fstBenfAdr,
t6.Ins_Pty_Adr as insPtyAdr,
t6.Ins_Obj_Nm as insObjNm,
t6.Ins_Amt as insAmt,
t6.Dctb_Amt as dctbAmt,
t6.EpAp as epap,
t6.Ins_StDt as insStdt,
t6.Ins_EdDt as insEddt,
		CASE t4.TASK_DEF_KEY_
WHEN 'AR_Itt_Pltfrm' THEN
	'01'
WHEN 'AR_Cfm_SplChain' THEN
	'02'
WHEN 'AR_Cfm_Dwstr_Entp' THEN
	'03'
WHEN 'AR_Cfm_Ins_Co' THEN
	'04'
WHEN 'AR_FrstIns_Pltfrm' THEN
	'05'
WHEN 'AR_SndInsc_Pltfrm' THEN
	'06'
WHEN 'AR_Tmt_Pltfrm' THEN
	'07'
ELSE
	''
END AS aplyPcstpCd
FROM
	(
		SELECT
			t3.*
		FROM
			t1_ar_inf t3,
			USER t5
		WHERE
			t3.SplChain = t5.splchain
			<include refid="query_criteria"></include>
	) t6
LEFT JOIN (
	SELECT
		t1.PROC_INST_ID_,
		t2.GROUP_ID_,
		t1.TASK_DEF_KEY_
	FROM
		act_ru_task t1,
		act_ru_identitylink t2
	WHERE
		t1.ID_ = t2.TASK_ID_
#	AND t2.GROUP_ID_ = '01'
) t4 ON t6.PROCESS_INST_ID = t4.PROC_INST_ID_
ORDER BY
	aplyPcstpCd,
	crt_tm DESC
		    
  </select>
  
  <select id="count" resultType="java.lang.Integer">
 SELECT
	   COUNT(*)
FROM
	(
		SELECT
			t3.*
		FROM
			t1_ar_inf t3,
			USER t5
		WHERE
			t3.SplChain = t5.splchain
			<include refid="query_criteria"></include>
	) t6
LEFT JOIN (
	SELECT
		t1.PROC_INST_ID_,
		t2.GROUP_ID_,
		t1.TASK_DEF_KEY_
	FROM
		act_ru_task t1,
		act_ru_identitylink t2
	WHERE
		t1.ID_ = t2.TASK_ID_
	AND t2.GROUP_ID_ = '01'
) t4 ON t6.PROCESS_INST_ID = t4.PROC_INST_ID_

  </select>
</mapper>